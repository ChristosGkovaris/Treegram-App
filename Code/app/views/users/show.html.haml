.row.top_row
  .col-sm-6.user_att
    %h2= @user.email
    - if @user.avatar_file_name
      = image_tag @user.avatar.url(:thumb)
  .col-sm-6
    = link_to 'Logout', log_out_path, class: ['btn', 'btn-danger', 'logout_btn']
    = link_to 'Add Photo', new_user_photo_path(@user), class: ['btn', 'btn-success', 'add_photo_btn']
%br/
%br/

%h2 All Users
.row
  - @all_users.each do |user|
    .col-sm-4
      %p
        = user.email
        - if current_user != user
          - if current_user.followed_users.include?(user)
            = button_to 'Unfollow', unfollow_user_path(user), method: :delete, class: ['btn', 'btn-warning']
          - else
            = button_to 'Follow', follow_user_path(user), method: :post, class: ['btn', 'btn-primary']

%h2 Photos of <%= @user.email %> and Followed Users
.row
  - @photos.each do |photo|
    .well.col-sm-4
      = image_tag photo.image.url(:medium)
      %p
        %strong Title:
        = photo.title

      - if current_user == photo.user
        = button_to 'Delete Photo', photo_path(photo), method: :delete, data: { confirm: 'Are you sure? This will delete the photo and all its comments and tags.' }, class: ['btn', 'btn-danger', 'btn-sm']

      %h3 Comments:
      - if photo.comments.any?
        - photo.comments.each do |comment|
          %p
            %strong= comment.user.email
            = comment.text
            - if current_user == comment.user || current_user == photo.user
              = button_to 'Delete', photo_comment_path(photo, comment), method: :delete, data: { confirm: 'Are you sure?' }, class: ['btn', 'btn-danger', 'btn-sm']
      - else
        %p No comments yet.

      %h4 Add a Comment:
      = form_for [photo, Comment.new] do |f|
        = f.text_area :text, placeholder: "Write your comment here...", rows: 3, class: "form-control"
        %br/
        = f.submit "Add Comment", class: ['btn', 'btn-primary']
      %hr/

      = form_for @tag do |f|
        = f.hidden_field :photo_id, value: photo.id
        = f.collection_select :user_id, @users, :id, :email
        = f.submit "Tag User"
      - photo.tags.each do |tag|
        = tag.user.email
